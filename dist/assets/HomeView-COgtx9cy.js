import{d as N,u as Q,c as s,o as t,r as x,a as p,w as m,b as f,e as W,V as $,_ as F,f as A,g as C,h as S,F as b,i as P,n as B,t as I,j as q,k as X,l as U,m as M,L as Y,p as Z,q as ee,s as z,v as te,x as D,y as j,z as L,T as E,A as ae,B as se}from"./index-CYgg2xjy.js";const oe={class:"toolbar"},ne=N({__name:"CommonToolbar",setup(g){const d=Q();return(r,o)=>(t(),s("div",oe,[x(r.$slots,"pagination",{},void 0),p($,{disabled:!W(d).hasSelectedRows},{default:m(()=>o[0]||(o[0]=[f("Отправить")])),_:1},8,["disabled"])]))}}),le=F(ne,[["__scopeId","data-v-69483c2f"]]),re={class:"table"},ie=["indeterminate"],ue={class:"table__body"},ce=["onClick"],de=["checked","onChange"],he=N({__name:"GridTable",props:{data:{},columns:{},selectedRows:{},dividers:{type:Boolean}},emits:["changeSelectedItems"],setup(g,{emit:d}){const r=A([]),o=g,w=d,u=C(()=>!o.selectedRows.length);function i(){const c=r.value[0].checked,v=o.data.map(a=>a.id);w("changeSelectedItems",c?v:[])}function k(c){w("changeSelectedItems",c)}return(c,v)=>(t(),s("div",re,[S("div",{class:q(["table__header",{"table-dividers":c.dividers}])},[(t(!0),s(b,null,P(c.columns,a=>(t(),s("div",{key:a.header,class:"table__cell table__cell--header",style:B({flex:a.widthFraction||1})},[a.slotName?x(c.$slots,`header-${a.slotName}`,{key:0},()=>[f(I(a.header),1)]):a.isCheckbox?(t(),s("input",{key:1,ref_for:!0,ref_key:"checkAll",ref:r,type:"checkbox",indeterminate:u.value,onChange:i},null,40,ie)):(t(),s(b,{key:2},[f(I(a.header),1)],64))],4))),128))],2),S("div",ue,[(t(!0),s(b,null,P(c.data,a=>(t(),s("div",{key:a.id,class:q(["table__row",{"table-dividers":c.dividers}]),onClick:e=>k(a.id)},[(t(!0),s(b,null,P(c.columns,e=>(t(),s("div",{key:e.header,class:"table__cell",style:B({flex:e.widthFraction||1})},[e.slotName&&c.$slots[`cell-${e.slotName}`]?x(c.$slots,`cell-${e.slotName}`,{key:0,item:a},void 0):e.isCheckbox?(t(),s("input",{key:1,class:"table__checkbox",type:"checkbox",checked:c.selectedRows.includes(a.id),onChange:n=>k(a.id),onClick:v[0]||(v[0]=X(()=>{},["stop"]))},null,40,de)):(t(),s(b,{key:2},[f(I(e.field?a[e.field]:"..."),1)],64))],4))),128))],10,ce))),128))])]))}}),ve=F(he,[["__scopeId","data-v-0a5a0b1b"]]),_e=N({__name:"VLoader",props:{color:{default:"#4a90e2"},size:{default:40}},setup(g){return(d,r)=>(t(),s("div",{class:"spinner",style:B({width:`${d.size}px`,height:`${d.size}px`,borderTopColor:d.color})},null,4))}}),me=F(_e,[["__scopeId","data-v-c6762e6f"]]),ge={class:"pagination"},pe={key:0},fe={key:1},G=1,Ce=N({__name:"PagePagination",props:{pagesCount:{}},emits:["changePage"],setup(g,{emit:d}){const r=g,o=d,w=U(),u=C(()=>{const e=Number(w.query.page);return e>0?e:1}),i=C(()=>{if(r.pagesCount<=5)return[];let e=Math.max(2,u.value-G),n=Math.min(r.pagesCount-1,u.value+G);n-e+1<3&&(e===2?n=Math.min(r.pagesCount-1,e+2):n===r.pagesCount-1&&(e=Math.max(2,n-2)));const T=[];for(let l=e;l<=n;l++)T.push(l);return T}),k=C(()=>r.pagesCount<=5?!1:i.value.length>0&&i.value[0]>2),c=C(()=>r.pagesCount<=5?!1:i.value.length>0&&i.value[i.value.length-1]<r.pagesCount-1),v=e=>u.value===e?"primary":"gray";function a(e){o("changePage",e)}return(e,n)=>(t(),s("ul",ge,[e.pagesCount<=5?(t(!0),s(b,{key:0},P(e.pagesCount,h=>(t(),s("li",{key:`page_${h}`},[p($,{color:v(h),onClick:T=>a(h)},{default:m(()=>[f(I(h),1)]),_:2},1032,["color","onClick"])]))),128)):(t(),s(b,{key:1},[S("li",null,[p($,{color:v(1),onClick:n[0]||(n[0]=h=>a(1))},{default:m(()=>n[2]||(n[2]=[f(" 1 ")])),_:1},8,["color"])]),k.value?(t(),s("li",pe,[p($,{disabled:""},{default:m(()=>n[3]||(n[3]=[f("...")])),_:1})])):M("",!0),(t(!0),s(b,null,P(i.value,h=>(t(),s("li",{key:`page_${h}`},[p($,{color:v(h),onClick:T=>a(h)},{default:m(()=>[f(I(h),1)]),_:2},1032,["color","onClick"])]))),128)),c.value?(t(),s("li",fe,[p($,{disabled:""},{default:m(()=>n[4]||(n[4]=[f("...")])),_:1})])):M("",!0),S("li",null,[p($,{color:v(e.pagesCount),onClick:n[1]||(n[1]=h=>a(e.pagesCount))},{default:m(()=>[f(I(e.pagesCount),1)]),_:1},8,["color"])])],64))]))}}),ke=F(Ce,[["__scopeId","data-v-c63c61d1"]]);function ye(g){return new Date(g).toLocaleString("ru-RU",{day:"numeric",month:"numeric",year:"numeric"})}function V(g,d=1){return g.map(r=>({...r,createdAt:ye(r.createdAt)})).slice((d-1)*6,d*6)}const be={key:0,class:"home"},we={class:"home__content"},$e=["src"],Se={key:1},Te={key:1,class:"home home__loader"},Ie=N({__name:"HomeView",setup(g){const d=[{header:"id",widthFraction:.2,field:"id"},{header:"loremText",widthFraction:2,field:"loremText",slotName:"loremText"},{header:"avatar",widthFraction:.3,field:"avatar",slotName:"avatar"}],r={isCheckbox:!0,widthFraction:.2},o=A([]),w=A([]),u=A([]),i=Q(),k=U(),c=C(()=>o.value.length===0?[]:Object.keys(o.value[0])),v=C(()=>i.isLoading),a=C(()=>i.tasksCount),e=C(()=>Math.ceil(a.value/Y)),n=C(()=>{var l;return Number((l=k.query)==null?void 0:l.page)||1});Z(()=>i.tableData,l=>{const _=l.length?V(l,n.value):[];o.value=_,se(()=>{i.setLoadingStatus(!1)})}),ee(async()=>{const l=z(k.query),[_,y]=await Promise.all([te(),D(l)]);i.setTasksCount(y.length),i.setDefaultTasksCount(_),o.value=y,o.value=V(o.value,n.value),i.setHashTableData(o.value);const O=c.value.reverse().map(R=>{const J={header:j[R],field:R,widthFraction:1},H=d.find(K=>K.header===R);return H?{...H,header:j[R]}:J});w.value.push(r,...O)});function h(l){if(Array.isArray(l))u.value=l;else{if(u.value.includes(l)){u.value=u.value.filter(y=>y!==l),i.setHasSelectedRows(u.value.length>0);return}u.value=[...u.value,l]}i.setHasSelectedRows(u.value.length>0)}async function T(l){await ae.replace({query:{...k.query,page:l}});const _=z(k.query);o.value=await D(_),o.value=V(o.value,n.value)}return(l,_)=>(t(),L(E,{name:"fade-slow",mode:"out-in"},{default:m(()=>[v.value?(t(),s("div",Te,[p(me,{size:80})])):(t(),s("div",be,[S("section",we,[_[1]||(_[1]=S("h2",{class:"home__content-title"},"Кошки на сегодня",-1)),p(E,{name:"fade"},{default:m(()=>[o.value.length?(t(),L(ve,{key:0,selectedIds:u.value,"onUpdate:selectedIds":_[0]||(_[0]=y=>u.value=y),data:o.value,columns:w.value,"selected-rows":u.value,onChangeSelectedItems:h,dividers:""},{"cell-avatar":m(({item:y})=>[S("img",{class:"home__table-img",src:y.avatar},null,8,$e)]),_:1},8,["selectedIds","data","columns","selected-rows"])):(t(),s("div",Se,"Ничего не найдено"))]),_:1})]),o.value.length?(t(),L(le,{key:0,tasksCount:a.value,class:"home__toolbar"},{pagination:m(()=>[p(ke,{class:"home__pagination",pagesCount:e.value,onChangePage:T},null,8,["pagesCount"])]),_:1},8,["tasksCount"])):M("",!0)]))]),_:1}))}}),Fe=F(Ie,[["__scopeId","data-v-657855ad"]]);export{Fe as default};
